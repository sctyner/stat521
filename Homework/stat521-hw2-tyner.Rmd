---
title: "STAT 521 - Homework #2"
author: "Sam Tyner"
date: "03/06/2018"
header-includes:
   - \usepackage{amsthm}
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Problem 1

*A researcher selected a simple random sample without replacement (SI) of 100 counties from the total of 3141 counties in the US. Data were collected from each of the counties regarding the acres devoted to farms and the number of farms in 1992. He calculated the average and standard deviation of the farm acres from the selected counties. The average was 275 acres (in thousands) and the standard deviation was 30 (in thousands).*

*Suppose he wants to make inference about the mean acres per county devoted to farms in 1992.*

1. *Write down the population parameter that he wants to estimate using the notations introduced in the class.*
2. *Estimate this population mean and the variance of the mean estimator using the HT-estimator.*
3. *Compute 95% confidence interval for the population mean.*

*Suppose he also wants to estimate the proportion of counties with at least 1000 farms. He found that in his sample there were 17 counties that had at least 1000 farms.*

4. *Estimate this population proportion using HT-estimator, and report the estimated variance of the estimator.*
5. *Suppose he also wants to estimate the total number of counties with at least 1000 farms. What are the estimate and the estimated variance of the estimator?*
6. *If he wants the sample proportion to be within $\pm 0.02$ of the population proportion with 95% confidence, how many more counties should he include into his sample to meet this requirement?*

## Problem 2

*A state senate candidate wants to conduct a household survey to estimate how many bumper stickers she needs for her supporters in one particular district. A sample of 5 households from all 100 households in this district is selected using probability proportional to size (PPS) sampling, where the size measure (or auxiliary variable) is the number of registered voters in the household. There are a total of 167 registered voters in this district. Each household in the sample is asked how many bumper stickers the household needs. The data from the survey are presented in Table 1.*

```{r tab1, results='asis', echo=FALSE}
#Sample Number of registered voters Number of bumper stickers household (i) in sample household (xi) needed by household (yi)
tab1 <- data.frame(matrix(c(1,3,3, 2,3,0, 3,2,1, 4,1,0, 5,1,0), ncol=3, byrow=T))
names(tab1) <- c("Sampled Household (i)", "Number of Registered Voters (x)", "Number of Bumper Stickers (y)")
knitr::kable(tab1, row.names = F, caption = "Bumper Sticker Survey")
```

1. *What are the inclusion probabilities for these five selected households under this PPS design?*
2. *Estimate the total number of bumper stickers needed for this district using the Hansen-Hurwitz estimator and give an estimate of the variance.*

## Problem 3


*A stratified random sample is to be drawn from a population which has three strata using STSI
design. We are interested in estimating the population total using the $\pi$-estimator under this design. A total of \$1500 is available for the survey. The cost function is $C = C_0 + \sum_{h=1}^3 C_h n_h$ , where the fixed cost, $C_0$ is \$250. We assume we know the population sizes for each stratum ($N_h$), the population variance for each stratum ($S^2_{hu}$) and the cost of each individual units in the stratum ($C_h$). The summary is shown in Table 2.*

```{r tab2, echo=FALSE, results='asis'}
tab2 <- data.frame(h = 1:3, N_h = c(500,2500,6000), S2 = c(400, 100, 25), C_h = rep("$5", 3))
knitr::kable(tab2, row.names = F, caption = "Allocation Problem")
```

1. *Determine the sample sizes for the optimal allocation.*
2. *Determine the sample sizes for the proportional allocation.*

## Problem 4

*Consider a finite population of size $N$ with a linear trend. For simplicity, assume that $y_i= \frac{i}{N}$ for $i = 1,2, \dots, N$. Let $n$ be the sample size with $\frac{N}{n} = m$, an integer. Using the following formula*
$$\sum_{k=1}^N k = \frac{N(N+1)}{2}, \quad \sum_{k=1}^N k^2 = \frac{N(N+1)(2N+1)}{6},$$
*answer the following questions.* 

1. *Compute $V_{SI}(\bar{y})$, the variance of the sample mean under simple random sampling (of size $n$).*
2. *Compute $V_{SY}(\bar{y})$, the variance of the sample mean under systematic sampling (of size $n$).*
3. *Compute $V_{ST}(\bar{y})$, the variance of the sample mean under stratified sampling with SI design in all strata and proportional allocation with $H = n$ strata (and $n_h = 1$) such that $y_1, \dots, y_{N/n}$ belongs to stratum 1, $y_{(N/n) + 1}, \dots, y_{2N/n}$ belongs to stratum 2, and so on.*
4. *Under the following superpopulation model $$E_{\zeta}(y_k) = \beta_{0} + \beta_1 k, \quad V_{\zeta}(y_k) = \sigma^2$$
Compute $E_{\zeta}(V_{SI}(\bar{y})), E_{\zeta}(V_{SY}(\bar{y})),$ and $E_{\zeta}(V_{ST}(\bar{y}))$. Under which of these designs does $\bar{y}$ have the smallest expected variance?*  

## Problem 5

*A supermarket chain has 450 stores spread over 32 cities. A company official wants to estimate the proportion of stores in the chain that do not meet a specified cleanliness criterion. Because of travel costs, she decides to use a two-stage SISI element sampling design to select 4 cities at the first stage and (approximately) half the stores within each of the 4 cities at the second stage. The data collected are in the following table:*

```{r tab3, echo = FALSE}
tab3 <- data.frame(City = 1:4, "TotalStores" = c(25,10,18,16), "SampledStores" = c(13,5,9,8), "NotMeetingCriterion" = c(3,1,4,2))
knitr::kable(tab3, row.names = F)
```

1. *Write down a HT-estimator for the proportion of stores not meeting the cleanliness criterion, and compute its value.*
2. *Write down a variance estimator for the estimator in (1) and calculate its value. You may only need to calculate the fist term which normally accounts for 98% of the total variation (i.e. use the simplified version of the variance estimator).*
   
